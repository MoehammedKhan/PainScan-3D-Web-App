<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Viewer Web App (dev)</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
        }
        canvas {
            width: 100%;
            height: calc(100vh - 60px);
            display: block;
        }
        .top-bar {
            background-color: #575d75;
            padding: 10px;
            text-align: center;
        }
        .top-bar a {
            color: #f0f0f0;
            font-family: Arial, sans-serif;
            text-decoration: none;
            font-weight: bold;
        }
        .checkbox-container {
            position: absolute;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <a href="index.html">Return to Selection</a>
    </div>
    <div class="checkbox-container">
        <label for="allCheckbox">All</label>
        <input type="checkbox" id="allCheckbox" class="option-checkbox" data-option="all">
        <br>
        <label for="redCheckbox">Red</label>
        <input type="checkbox" id="redCheckbox" class="option-checkbox" data-option="red">
        <br>
        <label for="yellowCheckbox">Yellow</label>
        <input type="checkbox" id="yellowCheckbox" class="option-checkbox" data-option="yellow">
        <br>
        <label for="greenCheckbox">Green</label>
        <input type="checkbox" id="greenCheckbox" class="option-checkbox" data-option="green">
        <br>
        <label for="blueCheckbox">Blue</label>
        <input type="checkbox" id="blueCheckbox" class="option-checkbox" data-option="blue">
    </div>
    <canvas id="canvas"></canvas>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script>
        const canvas = document.getElementById("canvas");
        const engine = new BABYLON.Engine(canvas, true);
        let currentOption = "all"; // Default option

        const createScene = async () => {
            const scene = new BABYLON.Scene(engine);
            const camera = new BABYLON.ArcRotateCamera("camera", 1.5, 1.5, 50, new BABYLON.Vector3(0, 1, 0), scene);
            camera.attachControl(canvas, true);

            const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0), scene);

            const loader = new BABYLON.AssetsManager(scene);

            function loadOption(option) {
                const meshTask = loader.addMeshTask("modelTask", "", `./1135018-${option}.gltf`);

                meshTask.onSuccess = (task) => {
                    task.loadedMeshes.forEach((mesh) => {
                        // You can add materials or customize the mesh here if needed
                    });
                };
            }

            // Initial load
            loadOption(currentOption);

            loader.onFinish = () => {
                engine.runRenderLoop(() => {
                    scene.render();
                });
            };

            loader.load();
        };

        createScene();

        window.addEventListener("resize", () => {
            engine.resize();
        });

        // Checkbox event listeners
        const checkboxes = document.querySelectorAll(".option-checkbox");

        checkboxes.forEach((checkbox) => {
            checkbox.addEventListener("change", () => {
                if (checkbox.checked) {
                    const option = checkbox.getAttribute("data-option");
                    currentOption = option;
                    engine.stopRenderLoop();
                    canvas.style.opacity = 0; // Smooth transition
                    setTimeout(() => {
                        // Clear the current scene and load the new option
                        const scene = engine.scenes[0];
                        scene.dispose();
                        createScene();
                        canvas.style.opacity = 1; // Smooth transition
                    }, 500); // Adjust the duration as needed for the transition
                }
            });
        });
    </script>
</body>
</html>
